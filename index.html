<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Waker Egg Catcher</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { width: 100%; height: 100%; overflow: hidden; background: #cdeaff; }
    canvas { display: block; margin: 0 auto; background: #87ceeb; }
    #gameCanvas { touch-action: none; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="480" height="640"></canvas>
<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const wakerImg = new Image();
  const duckImg = new Image();
  const eggImg = new Image();
  wakerImg.src = 'waker.png';
  duckImg.src = 'duck.png';
  eggImg.src = 'egg.png';

  const waker = {
    x: canvas.width / 2 - 40,
    y: canvas.height - 120,
    width: 80,
    height: 80,
    speed: 6
  };

  // Позиции уток как в "Ну, погоди!": верхняя левая, нижняя левая, верхняя правая, нижняя правая
  const ducks = [
    { x: 70, y: 100 },
    { x: 70, y: 220 },
    { x: 330, y: 100 },
    { x: 330, y: 220 }
  ];

  const eggPaths = [
    // Левый верхний путь
    [ {x: 70, y:100}, {x:90, y:150}, {x:110, y:200}, {x:130, y:270} ],
    // Левый нижний путь
    [ {x:70, y:220}, {x:90, y:270}, {x:110, y:320}, {x:130, y:390} ],
    // Правый верхний путь
    [ {x:330, y:100}, {x:310, y:150}, {x:290, y:200}, {x:270, y:270} ],
    // Правый нижний путь
    [ {x:330, y:220}, {x:310, y:270}, {x:290, y:320}, {x:270, y:390} ]
  ];

  let eggs = [];
  let eggDropInterval = 2000;
  let lastEggDrop = 0;
  let speedMultiplier = 1;
  let score = 0;

  function dropEgg() {
    const pathIndex = Math.floor(Math.random() * eggPaths.length);
    eggs.push({ path: eggPaths[pathIndex], index: 0, speed: 500 / (2 + speedMultiplier) });
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ducks.forEach(duck => ctx.drawImage(duckImg, duck.x, duck.y, 40, 40));
    ctx.drawImage(wakerImg, waker.x, waker.y, waker.width, waker.height);

    eggs.forEach(egg => {
      const pos = egg.path[egg.index];
      ctx.drawImage(eggImg, pos.x, pos.y, 20, 30);
    });

    ctx.fillStyle = 'black';
    ctx.font = '20px Arial';
    ctx.fillText('Score: ' + score, 10, 30);
  }

  function update() {
    if (Date.now() - lastEggDrop > eggDropInterval) {
      dropEgg();
      lastEggDrop = Date.now();
      speedMultiplier += 0.1;
      eggDropInterval = Math.max(500, eggDropInterval - 20);
    }

    eggs.forEach((egg, i) => {
      egg.index++;
      if (egg.index >= egg.path.length) {
        const finalPos = egg.path[egg.path.length - 1];
        if (
          finalPos.x + 20 > waker.x &&
          finalPos.x < waker.x + waker.width &&
          finalPos.y + 30 > waker.y &&
          finalPos.y < waker.y + waker.height
        ) {
          score++;
        }
        eggs.splice(i, 1);
      }
    });
  }

  function gameLoop() {
    draw();
    update();
    requestAnimationFrame(gameLoop);
  }

  document.addEventListener('keydown', e => {
    if (e.key === 'ArrowLeft') waker.x -= waker.speed;
    if (e.key === 'ArrowRight') waker.x += waker.speed;
    if (e.key === 'ArrowUp') waker.y -= waker.speed;
    if (e.key === 'ArrowDown') waker.y += waker.speed;
  });

  canvas.addEventListener('touchstart', e => {
    const touch = e.touches[0];
    moveTo(touch.clientX, touch.clientY);
  });
  canvas.addEventListener('touchmove', e => {
    const touch = e.touches[0];
    moveTo(touch.clientX, touch.clientY);
  });

  function moveTo(x, y) {
    const rect = canvas.getBoundingClientRect();
    waker.x = x - rect.left - waker.width / 2;
    waker.y = y - rect.top - waker.height / 2;
  }

  wakerImg.onload = () => requestAnimationFrame(gameLoop);
</script>
</body>
</html>
